{% extends "base.html" %}


{% block content %}


<div class="min-h-screen flex items-start justify-center mt-20">
    <div class="w-full max-w-3xl bg-white border border-[#899ea9] text-[#334155] p-6 rounded-2xl shadow-lg">
        <h2 class="text-2xl font-semibold text-center mb-4">Profile</h2> 

        
        <!-- User Info -->
        <h3 class="text-2xl font-semibold mb-4">Info :</h3> 
        <p>
            <span class="text-gray-600 font-semibold">Username:</span>
            <span class="text-red-600">{{ user.username }}</span><br>
            <span class="text-gray-600 font-semibold">First name:</span>
            <span class="text-red-600">{{ user.first_name }}</span><br>
            <span class="text-gray-600 font-semibold">Last name:</span>
            <span class="text-red-600">{{ user.last_name }}</span>
        </p>


        <!-- Tabs -->
        <div class="flex justify-center space-x-4 mb-8 mt-6">
            <button id="borrow-tab"
                class="tab-button px-5 py-2 text-sm sm:text-base font-medium rounded-lg transition-colors duration-200 border border-blue-600 bg-blue-600 text-white"
                onclick="showTab('borrow')">
                Borrow Requests
            </button>
            <button id="device-tab"
                class="tab-button px-5 py-2 text-sm sm:text-base font-medium rounded-lg transition-colors duration-200 border border-blue-600 text-blue-600 bg-white hover:bg-blue-50"
                onclick="showTab('device')">
                Devices
            </button>
            <button id="return-tab"
                class="tab-button px-5 py-2 text-sm sm:text-base font-medium rounded-lg transition-colors duration-200 border border-blue-600 text-blue-600 bg-white hover:bg-blue-50"
                onclick="showTab('return')">
                Return Requests
            </button>
        </div>



        <!-- Borrow Section -->
        <div id="borrow-section">
            <h3 class="text-2xl font-semibold mb-4">Your Borrow Request History :</h3> 
            {% for req in borrows %}
            <a href="#" class="block bg-[#f1f5f9] rounded-xl p-5 shadow-sm hover:shadow-md hover:bg-[#e2e8f0] transition duration-300 mb-3">
                <h3 class="text-xl font-semibold text-[#334155]">{{ req }}</h3>
                <p class="text-[#475569]">
                    Borrowed on {{ req.date_requested }} &bull; Return by {{ req.return_date }}
                </p>
                <div class="flex justify-start mt-2">
                    {% if req.approved %}
                    <span class="inline-block px-3 py-1 text-sm font-semibold text-green-800 bg-green-200 rounded-lg">Approved</span>
                    {% else %}
                    <span class="inline-block px-3 py-1 text-sm font-semibold text-yellow-800 bg-yellow-200 rounded-lg">Verifying</span>
                    {% endif %}
                </div>
            </a>
            {% empty %}
            <p class="text-gray-500">You haven't requested any borrows yet.</p>
            {% endfor %}
        </div>



        <!-- Device Section -->
        <div id="device-section" class="hidden">
            <h3 class="text-2xl font-semibold mb-4">Your borrowed devices:</h3>
            {% for instance in approves %}
            <a href="{% url 'devices:device-detail' instance.device.id %}" class="block bg-[#f1f5f9] rounded-xl p-5 shadow-sm hover:shadow-md hover:bg-[#e2e8f0] transition duration-300 mb-3">
                <h3 class="text-xl font-semibold text-[#334155]">{{ instance.device.name }}</h3>
                <p class="text-[#475569]">
                    {{ instance.device.type }}<br> Borrowed on {{ instance.date_requested }} &bull; Return by {{ instance.return_date }}
                </p>
            </a>
            {% empty %}
            <p class="text-gray-500">You don't have any devices yet.</p>
            {% endfor %}
        </div>



        <!-- Return Section -->
        <div id="return-section" class="hidden">
            <h3 class="text-2xl font-semibold mb-4">Your Return Request History :</h3> 
            {% for req in returns %}
            <a href="#" class="block bg-[#f1f5f9] rounded-xl p-5 shadow-sm hover:shadow-md hover:bg-[#e2e8f0] transition duration-300 mb-3">
                <h3 class="text-xl font-semibold text-[#334155]">{{ req }}</h3>
                <p class="text-[#475569]">
                    Condition: {{ req.condition }} &bull; Feedback: {{ req.feedback|slice:":20" }}
                </p>
                <div class="flex justify-start mt-2">
                    {% if req.approved %}
                    <span class="inline-block px-3 py-1 text-sm font-semibold text-green-800 bg-green-200 rounded-lg">Approved</span>
                    {% else %}
                    <span class="inline-block px-3 py-1 text-sm font-semibold text-yellow-800 bg-yellow-200 rounded-lg">Verifying</span>
                    {% endif %}
                </div>
            </a>
            {% empty %}
            <p class="text-gray-500">You haven't requested any returns yet.</p>
            {% endfor %}
        </div>
    </div>
</div>


<script>
    function showTab(selectedTab) {
        var tabs = ['borrow', 'device', 'return'];

        for (var i = 0; i < tabs.length; i++) 
        {
            var tab = tabs[i];

            var button = document.getElementById(tab + '-tab');
            var section = document.getElementById(tab + '-section');

            if (tab === selectedTab) 
            {
                section.classList.remove('hidden');
                button.classList.add('bg-blue-600', 'text-white');
                button.classList.remove('bg-white', 'text-blue-600', 'hover:bg-blue-50');
            } else {
                section.classList.add('hidden');
                button.classList.remove('bg-blue-600', 'text-white');
                button.classList.add('bg-white', 'text-blue-600', 'hover:bg-blue-50');
            }
        }
    }
</script>

{% endblock content %}

